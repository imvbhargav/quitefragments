---
import "../styles/global.css";
import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
const {
    title = "Home",
    description = "A blog of fragments.",
    date,
    ogImage,
} = Astro.props;

const siteUrl = "http://localhost:4321/"; // change to your site URL
const fullOgImage = ogImage ? siteUrl + ogImage : siteUrl + "/default-og.png";
---

<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width" />
        <link rel="icon" type="image/png" href="/rainbow.png" />
        <meta name="generator" content={Astro.generator} />
        <title>Quite Fragments | {title}</title>
        <!-- Dynamic SEO -->
        <meta name="description" content={description} />

        <!-- Open Graph -->
        <meta property="og:type" content="article" />
        <meta property="og:title" content={title} />
        <meta property="og:description" content={description} />
        <meta property="og:image" content={fullOgImage} />
        <meta property="og:url" content={siteUrl + Astro.url.pathname} />
        {date && <meta property="article:published_time" content={date} />}

        <!-- Twitter Card -->
        <meta name="twitter:card" content="summary_large_image" />
        <meta name="twitter:title" content={title} />
        <meta name="twitter:description" content={description} />
        <meta name="twitter:image" content={fullOgImage} />
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Arvo:ital,wght@0,400;0,700;1,400;1,700&family=Atkinson+Hyperlegible:ital,wght@0,400;0,700;1,400;1,700&family=Cormorant+Garamond:ital,wght@0,300..700;1,300..700&family=Dancing+Script:wght@400..700&family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Playfair+Display:ital,wght@0,400..900;1,400..900&family=Space+Grotesk:wght@300..700&display=swap"
            rel="stylesheet"
        />
        <script is:inline>
            const colors = {
                classic: {
                    dark: { bg: "#1a1c1e", fg: "#e1e4e8", acc: "#58a6ff" },
                    light: { bg: "#ffffff", fg: "#24292e", acc: "#0366d6" },
                },
                catppuccin: {
                    dark: { bg: "#1e1e2e", fg: "#cdd6f4", acc: "#cba6f7" },
                    light: { bg: "#eff1f5", fg: "#4c4f69", acc: "#797e93" },
                },
                deepcontrast: {
                    dark: { bg: "#000000", fg: "#ffffff", acc: "#555555" },
                    light: { bg: "#ffffff", fg: "#000000", acc: "#aaaaaa" },
                },
                retrosunset: {
                    dark: { bg: "#282828", fg: "#ebdbb2", acc: "#d65d0e" },
                    light: { bg: "#fbf1c7", fg: "#3c3836", acc: "#d65d0e" },
                },
                ocean: {
                    dark: { bg: "#1e2029", fg: "#c4d1e2", acc: "#7fb8d4" },
                    light: { bg: "#f2f4f7", fg: "#3c4355", acc: "#5897b6" },
                },
                everforest: {
                    dark: { bg: "#272e33", fg: "#d3c6aa", acc: "#8aa083" },
                    light: { bg: "#fdf6e3", fg: "#53463a", acc: "#7d917d" },
                },
                modern: {
                    dark: { bg: "#161618", fg: "#d4d4d4", acc: "#69c9d0" },
                    light: { bg: "#ffffff", fg: "#1f1f1f", acc: "#008e9b" },
                },
                elegant: {
                    dark: { bg: "#292d3e", fg: "#c3c6d2", acc: "#b281f0" },
                    light: { bg: "#f5f6f8", fg: "#383b4b", acc: "#8764b8" },
                },
            };

            // Apply theme before first paint
            const storedTheme = localStorage.getItem("theme");
            const systemTheme = window.matchMedia(
                "(prefers-color-scheme: dark)",
            ).matches
                ? "dark"
                : "light";
            const theme = storedTheme || systemTheme;
            if (theme === "dark") {
                document.documentElement.classList.add("dark");
            }

            // Change handler
            window.colorSchemeChange = function (color) {
                document.documentElement.style.setProperty(
                    "--color-bglight",
                    colors[color].light.bg,
                );
                document.documentElement.style.setProperty(
                    "--color-bgdark",
                    colors[color].dark.bg,
                );
                document.documentElement.style.setProperty(
                    "--color-fglight",
                    colors[color].light.fg,
                );
                document.documentElement.style.setProperty(
                    "--color-fgdark",
                    colors[color].dark.fg,
                );
                document.documentElement.style.setProperty(
                    "--color-acclight",
                    colors[color].light.acc,
                );
                document.documentElement.style.setProperty(
                    "--color-accdark",
                    colors[color].dark.acc,
                );
                localStorage.setItem("color", color);
            };

            // Apply stored color before first paint
            const storedColor = localStorage.getItem("color") || "classic";
            window.colorSchemeChange(storedColor);

            const selectedFont = localStorage.getItem("uifont");
            document.documentElement.style.setProperty(
                "--font-uifont",
                selectedFont ?? "var(--font-space)",
            );
        </script>
    </head>
    <body
        class="min-h-screen bg-bglight dark:bg-bgdark text-fglight dark:text-fgdark flex items-center flex-col font-uifont"
    >
        <Header />
        <main
            class="w-full flex-grow max-w-5xl lg:border-x-2 border-acclight/50 dark:border-accdark/50 pb-4"
        >
            <slot />
        </main>
        <Footer />
    </body>
</html>
